
\onecolumn
\twocolumn

# Gr치ficos con R

En cap칤tulos anteriores, vimos las funciones `curve()` y `barplot()` para graficar funciones matem치ticas y frecuencias respectivamente. Estas son funciones base de R para la visualizaci칩n, sobre las cuales se fundamenta el manejo gr치fico en R.

Los gr치ficos en **R** son una parte esencial para el an치lisis y la comunicaci칩n de datos.

A trav칠s de ellos podemos visualizar patrones, distribuciones, correlaciones y comportamientos complejos que dif칤cilmente se aprecian en tablas o valores num칠ricos.

En este cap칤tulo iniciamos la construcci칩n de los conceptos fundamentales del sistema gr치fico de **R**, su estructura, y las diferentes formas en que podemos generar visualizaciones.

## Sistemas gr치ficos en R

En **R** existen distintos **sistemas gr치ficos** que permiten generar visualizaciones de diversa complejidad y estilo.  
Cada uno tiene su propio enfoque, ventajas y nivel de control sobre los elementos visuales.

### 1. Sistema base (Base Graphics)

Es el sistema **nativo de R**, incluido desde sus primeras versiones.  
Se basa en funciones como `plot()`, `hist()`, `boxplot()` y `lines()` que dibujan directamente sobre una ventana gr치fica o "device".

- Ideal para gr치ficos r치pidos y exploratorios.  
- Permite a침adir elementos gr치ficos adicionales (t칤tulos, l칤neas, texto, etc.) de forma manual.  
- Se controla principalmente a trav칠s de **funciones y par치metros**.

Ejemplo cl치sico:

```{r, echo=TRUE}
plot(
  iris$Sepal.Length, iris$Sepal.Width,
  main = "Rel largo/ancho S칠palo",
  xlab = "Largo del S칠palo",
  ylab = "Ancho del S칠palo",
  col = "blue", pch = 19
)
```
---

### 2. Sistema Lattice

El sistema **Lattice** (paquete `lattice`) introdujo un enfoque **declarativo**:
en lugar de construir un gr치fico paso a paso, se describe **qu칠** se desea graficar y R decide **c칩mo** hacerlo.

*  Facilita la creaci칩n de **gr치ficos multivariados** y **paneles condicionados** (por grupos o factores).
*  Produce gr치ficos de alta calidad con **menos c칩digo**.
*  Sin embargo, **no es tan flexible** para a침adir elementos despu칠s de creado el gr치fico.

Ejemplo:

```{r, echo=TRUE}
library(lattice)
xyplot(
  Sepal.Length ~ Sepal.Width | Species,
  data = iris
)
```

---

### 3. Sistema ggplot2

El sistema **ggplot2** (paquete del mismo nombre) est치 basado en la **Gram치tica de los Gr치ficos** (*The Grammar of Graphics*).
Su enfoque es **modular**: cada gr치fico se construye agregando capas (`+`) que representan datos, est칠ticas, geometr칤as, escalas y temas.

* 游댲 Extremadamente **flexible y potente**.
* 游댲 Permite generar gr치ficos profesionales, reproducibles y altamente personalizables.
* 游댲 Ideal para an치lisis estad칤stico y comunicaci칩n cient칤fica.

Ejemplo:

```{r, echo=TRUE}
library(ggplot2)

ggplot(
  iris,
  aes(
    x = Sepal.Length, y = Sepal.Width,
    color = Species
  )
) +
geom_point(size = 3) +
labs(title = "Rel s칠palo largo/ancho") +
theme_minimal()
```

---

> **Nota**: *En este manual nos concentraremos principalmente en el sistema **base** de **R**, ya que es la base conceptual sobre la cual se construyen los dem치s sistemas y es el m치s adecuado para aprender los fundamentos de la generaci칩n de gr치ficos.*

---

## Funci칩n `curve()`

Esta funci칩n permite graficar una funci칩n matem치tica continua en un rango especificado.

- Sintaxis b치sica: 
  ```R
  curve(
    expr, # The name of a function
    from,
    to,
    col,
    lwd,
    main,
    ylab
  )
  ```
- 칔til para visualizar densidades, funciones de distribuci칩n y cualquier funci칩n matem치tica "_expresable_" en **R**.

## Funci칩n `barplot()`

Crea gr치ficos de barras a partir de vectores o tablas de frecuencias.

- Sintaxis b치sica:
  ```R
  barplot(
    height,
    names.arg,
    col,
    main,
    ylab
  )
  ```
- Ideal para representar datos discretos o categ칩ricos y sus frecuencias.

---

## Combinando curvas en un mismo gr치fico

Podemos superponer varias curvas con `curve()` usando `add = TRUE`.

Aqu칤 un ejemplo combinando distribuci칩n normal, exponencial y uniforme.

```{r, echo=TRUE}
curve(
  dnorm(x, mean=0, sd=1),
  from=-2,
  to=4,
  col="blue",
  lwd=2,
  ylab="Densidad",
  main="Normal, Exponencial y Uniforme"
)
curve(
  dexp(x, rate=1),
  from=0,
  to=4,
  col="#801100",
  lwd=2,
  add=TRUE
)
curve(
  dunif(x, min=0, max=4),
  from=0,
  to=4,
  col="purple",
  lwd=2,
  add=TRUE
)
legend(
  "topright",
  legend= c(
    "Normal", "Exponencial", "Uniforme"
  ),
  col=c("blue", "#801100", "purple"),
  lwd=2
)
```

---

## Comparaci칩n de barras entre distribuciones discretas

Compararemos las distribuciones Poisson, Binomial y Geom칠trica con barras.

```{r, echo=TRUE}
# Valores
x_pois <- 0:15
x_binom <- 0:15
x_geom <- 0:15

# Poison
pois_vals <- dpois(x_pois, lambda=5)
# Binomials
binom_vals <- dbinom(x_binom, size=15, prob=0.4)
# Geometrica
geom_vals <- dgeom( x_geom, prob=0.3)

# Para barras juntas, creamos matriz
vals_matrix <- rbind(
  pois_vals, binom_vals, geom_vals
)

# Ajustamos espacio para las barras
barplot(
  vals_matrix,
  beside=TRUE,
  col=c("red", "orange", "blue"),
  names.arg=0:15,
  ylim=c(0, 0.35),
  main="Poisson, Binomial y Geom칠trica",
  ylab="Probabilidad", xlab="Valor"
)

legend(
  "topright",
  legend=c(
    "Poisson", "Binomial", "Geom칠trica"
  ),
  fill=c("red", "orange", "blue")
)
```


## Tipos de funciones gr치ficas

Dentro del sistema gr치fico base, las funciones pueden clasificarse en dos grandes categor칤as:
**funciones de alto nivel** y **funciones de bajo nivel**.

### Funciones de alto nivel

Estas funciones **crean un nuevo gr치fico desde cero** y abren (o reutilizan) un dispositivo gr치fico.

> **Ejemplos**: `plot()`, `hist()`, `boxplot()`, `barplot()`, `pie()`.

Caracter칤sticas:

* Inician una nueva figura.
* Borran el contenido previo del dispositivo.
* Permiten establecer ejes, t칤tulos, y etiquetas principales.

```r
hist(
  iris$Sepal.Length,
  main = "Histograma largo s칠palo"
)
```

---

### Funciones de bajo nivel

Estas funciones **a침aden elementos a una gr치fica existente** sin borrar lo anterior.

> **Ejemplos**: `points()`, `lines()`, `text()`, `abline()`, `legend()`.

Caracter칤sticas:

* Modifican un gr치fico ya generado.
* Se usan para **superponer informaci칩n adicional** (tendencias, etiquetas, marcas, etc.).

Ejemplo combinando ambas:

```r
plot(
  iris$Sepal.Length,
  iris$Sepal.Width,
  main = "Sepalos", pch = 19
)
abline(
  lm(
    Sepal.Width ~ Sepal.Length, data = iris
  ),
  col = "red", lwd = 2
)
```

Este tipo de funciones las veremos mas adelante cuando realicemos gr치ficas mas complejas con m칰ltiples elementos.

---



## Dispositivos gr치ficos (*devices*)

En R, un **dispositivo gr치fico** es el medio donde se dibuja el gr치fico.
Puede ser una **ventana interactiva**, un **archivo** (PDF, PNG, JPEG, SVG), o incluso una **pantalla virtual** para renderizar figuras en segundo plano.


### Tipos de dispositivos gr치ficos en R

* **Ventana del S.O**: 칔til para trabajar de forma interactiva
  - **Linux / Unix - Ventana X11***
    - **Funci칩n:** `x11()`: Ventana gr치fica interactiva est치ndar utilizada en sistemas basados en X11.

  - **Windows - Ventana Windows**
    - **Funci칩n:** `windows()` : Abre una ventana gr치fica nativa en el entorno Windows.

  - **MacOS - Ventana Quartz**
    - **Funci칩n:** `quartz()`: Dispositivo gr치fico nativo de macOS.

* **PDF (Archivo vectorial)**
  * **Funci칩n** `pdf("archivo.pdf")`: Genera gr치ficos en formato vectorial de alta resoluci칩n, ideales para impresi칩n o publicaci칩n cient칤fica.

* **PNG / JPEG (Mapas de bits)**
  * **Funciones** `png()`, `jpeg()`: Crean im치genes rasterizadas, apropiadas para presentaciones, sitios web o informes digitales.

### Ejemplo:

Cuando llamamos a una funci칩n de alto nivel, R abre un dispositivo por defecto dependiendo del entorno donde estemos trabajando.

```r
# Guardar un gr치fico como archivo PNG
png(
  "img/grafico_iris.png",
  width = 800, height = 600
)
# No imprime la imagen pero la va a guardar
plot(
  iris$Petal.Length,
  iris$Petal.Width,
  main = "Rel largo/ancho del p칠talo",
  col = iris$Species, pch = 19
)
# Cerrando el dispositivo y guardando cambios.
dev.off()
```

> `dev.off()` **cierra el dispositivo** y guarda la imagen generada.

\onecolumn
